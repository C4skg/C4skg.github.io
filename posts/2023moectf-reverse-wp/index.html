<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>2023MoeCTF(Reverse入门学习) - C4skg&#39;s Blog</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="1 前言最近在学习 Reverse 这块的内容，刚好这次题量大且适合新手，就拿来练练手 还有些没做出来的题目就后期看大佬的题解及时复现了 2 Reverse入门指北" /><meta name="keywords" content='2023MoeCTF, Reverse' /><meta itemprop="name" content="2023MoeCTF(Reverse入门学习)">
<meta itemprop="description" content="1 前言最近在学习 Reverse 这块的内容，刚好这次题量大且适合新手，就拿来练练手 还有些没做出来的题目就后期看大佬的题解及时复现了 2 Reverse入门指北"><meta itemprop="datePublished" content="2023-10-08T13:26:44+00:00" />
<meta itemprop="dateModified" content="2023-10-08T13:26:44+00:00" />
<meta itemprop="wordCount" content="7713">
<meta itemprop="keywords" content="2023MoeCTF,Reverse," /><meta property="og:title" content="2023MoeCTF(Reverse入门学习)" />
<meta property="og:description" content="1 前言最近在学习 Reverse 这块的内容，刚好这次题量大且适合新手，就拿来练练手 还有些没做出来的题目就后期看大佬的题解及时复现了 2 Reverse入门指北" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/posts/2023moectf-reverse-wp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-08T13:26:44+00:00" />
<meta property="article:modified_time" content="2023-10-08T13:26:44+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="2023MoeCTF(Reverse入门学习)"/>
<meta name="twitter:description" content="1 前言最近在学习 Reverse 这块的内容，刚好这次题量大且适合新手，就拿来练练手 还有些没做出来的题目就后期看大佬的题解及时复现了 2 Reverse入门指北"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="//localhost:1313/posts/2023moectf-reverse-wp/" /><link rel="next" href="//localhost:1313/posts/89d59c3/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "2023MoeCTF(Reverse入门学习)",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "\/\/localhost:1313\/posts\/2023moectf-reverse-wp\/"
    },"genre": "posts","keywords": "2023MoeCTF, Reverse","wordcount":  7713 ,
    "url": "\/\/localhost:1313\/posts\/2023moectf-reverse-wp\/","datePublished": "2023-10-08T13:26:44+00:00","dateModified": "2023-10-08T13:26:44+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "作者"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="C4skg&#39;s Blog"><span class="header-title-text">C4skg&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/"
                
                
              ><i class="fa-solid fa-home fa-fw fa-sm" aria-hidden="true"></i> 首页</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                
                
              ><i class="fa-solid fa-link fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="C4skg&#39;s Blog"><span class="header-title-text">C4skg&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/"
                  
                  
                ><i class="fa-solid fa-home fa-fw fa-sm" aria-hidden="true"></i> 首页</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  
                  
                ><i class="fa-solid fa-link fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>2023MoeCTF(Reverse入门学习)</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Anonymous</span></span></div><div class="post-meta-line"><span title="发布于 2023-10-08 13:26:44"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2023-10-08">2023-10-08</time></span>&nbsp;<span title="7713 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 7800 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 16 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#reverse入门指北">Reverse入门指北</a></li>
    <li><a href="#base_64">base_64</a></li>
    <li><a href="#upx">UPX!</a></li>
    <li><a href="#xor">Xor</a></li>
    <li><a href="#android">ANDROID</a></li>
    <li><a href="#rrrrrc4">RRRRRc4</a></li>
    <li><a href="#smc">SMC</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#equation">EQUATION</a></li>
    <li><a href="#junk_code">junk_code</a></li>
    <li><a href="#ezandroid">ezandroid</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><div class="details admonition warning open">
      <div class="details-summary admonition-title">
        <i class="icon fa-solid fa-exclamation-triangle fa-fw" aria-hidden="true"></i>警告<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
      </div>
      <div class="details-content">
        <div class="admonition-content">本文最后更新于 2023-10-08，文中内容可能已过时。</div>
      </div>
    </div><h2 id="前言" class="heading-element">
  <a href="#%e5%89%8d%e8%a8%80" class="heading-mark"></a>1 前言</h2><p>最近在学习 <code>Reverse</code> 这块的内容，刚好这次题量大且适合新手，就拿来练练手
还有些没做出来的题目就后期看大佬的题解及时复现了</p>
<h2 id="reverse入门指北" class="heading-element">
  <a href="#reverse%e5%85%a5%e9%97%a8%e6%8c%87%e5%8c%97" class="heading-mark"></a>2 Reverse入门指北</h2><blockquote>
<p>INTRO_RE.exe</p>
</blockquote>
<p>使用 <code>ida</code> 打开，调用 <code>F12</code> 查看字符串即可</p>
<div class="highlight" id="id-1"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">moectf</span><span class="p">{</span><span class="n">F1rst_St3p_1s_D0ne</span><span class="p">}</span></span></span></code></pre></div><h2 id="base_64" class="heading-element">
  <a href="#base_64" class="heading-mark"></a>3 base_64</h2><blockquote>
<p>base64.pyc</p>
</blockquote>
<p>考的是 <code>python</code> 的逆向，需要将 <code>.pyc</code> 文件进行反编译</p>
<p>使用工具 <code>uncompyle6</code> 将 <code>.pyc</code> 文件反编译为 <code>py</code> 文件即可</p>
<div class="highlight" id="id-2"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">uncompyle6 -o base_64.py base_64.pyc</span></span></code></pre></div><p>得到原始代码</p>
<div class="highlight" id="id-3"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">str1</span> <span class="o">=</span> <span class="s1">&#39;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">string1</span> <span class="o">=</span> <span class="s1">&#39;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">string2</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;welcome to moectf</span><span class="se">\n</span><span class="s1">input your flag and I wiil check it:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">enc_flag</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">enc_flag</span> <span class="o">=</span> <span class="n">enc_flag</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">string2</span><span class="p">,</span> <span class="n">string1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">enc_flag</span> <span class="o">==</span> <span class="n">str1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;good job!!!!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;something wrong???&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span></span></code></pre></div><p>很明显的 <code>base64</code> 换表，核心是 <code>maketrans</code> 函数，需要讲原表 <code>string2</code> 和 新表 <code>string1</code> 进行替换，长度一样即可</p>
<div class="highlight" id="id-4"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{pYc_And_Base64~}</span></span></code></pre></div><h2 id="upx" class="heading-element">
  <a href="#upx" class="heading-mark"></a>4 UPX!</h2><blockquote>
<p>UPX!.exe</p>
</blockquote>
<p>根据题目名也可以知道这个程序经过 <code>upx</code> 加壳，使用 <code>upx</code> 脱壳即可</p>
<div class="highlight" id="id-5"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">upx -d <span class="s2">&#34;UPX!.exe&#34;</span></span></span></code></pre></div><p>脱壳后使用 <code>ida</code> 打开，找到核心的代码</p>
<div class="highlight" id="id-6"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">sub_140079760</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">[</span><span class="mi">76</span><span class="p">];</span> <span class="c1">// [rsp+28h] [rbp+8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+74h] [rbp+54h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+148h] [rbp+128h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">34</span><span class="n">i64</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">858993460</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v0</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140075557</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_1401A7008</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;welcome to moectf&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;I put a shell on my program to prevent you from reversing it, you will never be able to reverse it hhhh~~&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;Now tell me your flag:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x2Au</span><span class="n">i64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_1400727F8</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="nf">sub_140073829</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&gt;=</span> <span class="n">v2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x67u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">byte_140196000</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v6</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_140073973</span><span class="p">(</span><span class="s">&#34;try again~~&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_1400723F7</span><span class="p">(</span><span class="mi">0</span><span class="n">i64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073973</span><span class="p">(</span><span class="s">&#34;you are so clever!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140074BCF</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unk_140162070</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>已加密的变量在 <code>byte_140196000</code>，且将每个明文的值去异或上 <code>0x67</code> ,最后与密文比较，就是加密过程</p>
<p>解密脚本如下</p>
<div class="highlight" id="id-7"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;0A 08 02 04 13 01 1C 57 0F 38 1E 57 12 38 2C 09 57 10 38 2F 57 10 38 13 08 38 35 02 11 54 15 14 02 38 32 37 3F 46 46 46 1A&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x67</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></div><p>运行即可得到 <code>flag</code></p>
<div class="highlight" id="id-8"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{0h_y0u_Kn0w_H0w_to_Rev3rse_UPX!!!}</span></span></code></pre></div><h2 id="xor" class="heading-element">
  <a href="#xor" class="heading-mark"></a>5 Xor</h2><blockquote>
<p>XOR.exe</p>
</blockquote>
<p><code>ida</code> 打开后的入口反编译就是题目代码</p>
<div class="highlight" id="id-9"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-34h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">input</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span> <span class="c1">// [rsp+30h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+5Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">_main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">input</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please input the flag:</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">gets</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x39</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Seems not right&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;GOOD!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>上面程序中，可以得知，密文为 <code>enc</code>，且将输入的明文一一异或 <code>0x39</code> 并和对应下标密文对比，解密手段可以参照上一题</p>
<div class="highlight" id="id-10"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;54 56 5C 5A 4D 5F 42 60 56 4C 66 52 57 09 4E 66 51 09 4E 66 4D 09 66 61 09 6B 18 44&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x39</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></div><p>运行后即可得到 <code>flag</code></p>
<div class="highlight" id="id-11"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{You_kn0w_h0w_t0_X0R!}</span></span></code></pre></div><h2 id="android" class="heading-element">
  <a href="#android" class="heading-mark"></a>6 ANDROID</h2><blockquote>
<p>BasicAndroid.apk</p>
</blockquote>
<p>使用 <code>jadx</code> 工具对其进行反编译</p>
<p>具体的代码在 <code>com.doctor3.basicandroid4</code> 的 <code>MainActivity</code> 函数体中</p>
<div class="highlight" id="id-12"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainActivity</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AppCompatActivity</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">25</span><span class="p">,</span><span class="w"> </span><span class="n">7</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">14</span><span class="p">,</span><span class="w"> </span><span class="n">27</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">24</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">4</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">11</span><span class="p">,</span><span class="w"> </span><span class="n">29</span><span class="p">,</span><span class="w"> </span><span class="n">6</span><span class="p">,</span><span class="w"> </span><span class="n">7</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\f&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">24</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">28</span><span class="p">,</span><span class="w"> </span><span class="n">21</span><span class="p">,</span><span class="w"> </span><span class="n">27</span><span class="p">,</span><span class="w"> </span><span class="n">28</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="c1">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">bundle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">bundle</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">EditText</span><span class="w"> </span><span class="n">editText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">EditText</span><span class="p">)</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">input</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">((</span><span class="n">Button</span><span class="p">)</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">check</span><span class="p">)).</span><span class="na">setOnClickListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">View</span><span class="p">.</span><span class="na">OnClickListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// from class: com.doctor3.basicandroid.MainActivity.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nd">@Override</span><span class="w"> </span><span class="c1">// android.view.View.OnClickListener</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onClick</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">view</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">editText</span><span class="p">.</span><span class="na">getText</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">31</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;长度不对哦&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">getBytes</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">31</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">bytes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">key</span><span class="o">[</span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">key</span><span class="p">.</span><span class="na">length</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">enc</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;好像有哪里不对&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;恭喜！回答正确&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div><p>可以得到以下信息</p>
<ul>
<li>密文为 <code>enc</code> 变量</li>
<li><code>key</code> 变量是异或的值</li>
<li>输入的明文与 <code>key</code> 进行异或后，和密文 <code>enc</code> 对应的下标进行对比</li>
</ul>
<p>这里可以将 <code>key</code> 理解为 <code>repeat</code> 成长度为 <code>31</code> 的新 <code>key</code>,或每次越界后从头开始，取余即可，以下是解密脚本</p>
<div class="highlight" id="id-13"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">v</span> <span class="o">^</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]))),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></div><p>直接运行即可</p>
<div class="highlight" id="id-14"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{Java_in_Android_1s_easy}</span></span></code></pre></div><h2 id="rrrrrc4" class="heading-element">
  <a href="#rrrrrc4" class="heading-mark"></a>7 RRRRRc4</h2><blockquote>
<p>RRRRRc4.exe</p>
</blockquote>
<p>看题目名称，应该可以知道考的是 <code>RC4</code> 算法</p>
<div class="highlight" id="id-15"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">sub_140079A70</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v3</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+30h] [rbp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [rsp+40h] [rbp+10h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [rsp+160h] [rbp+130h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v7</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span> <span class="c1">// [rsp+278h] [rbp+248h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+2A4h] [rbp+274h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+2C4h] [rbp+294h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">172</span><span class="n">i64</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">858993460</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v0</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_14007555C</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_1401A7007</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v5</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v6</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="s">&#34;moectf2023&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;welcome to moectf!!!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;This is a very common algorithm &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140073581</span><span class="p">(</span><span class="s">&#34;show your flag:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_1400727F8</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">byte_140197260</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_140073829</span><span class="p">(</span><span class="n">byte_140197260</span><span class="p">)</span> <span class="o">==</span> <span class="mi">37</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_140075052</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v5</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">byte_140197260</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mh">0x26</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">byte_140196000</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">byte_140197260</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">++</span><span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">==</span> <span class="mi">37</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_140073973</span><span class="p">(</span><span class="s">&#34;right!flag is your input!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_140073973</span><span class="p">(</span><span class="s">&#34;try again~&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_140074BCF</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unk_140162100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>这里只是外部，用来对比校验结果是否符合的，先将密文提取，在变量 <code>byte_140196000</code> 中</p>
<p>密文如下:</p>
<div class="highlight" id="id-16"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">1B 9B FB 19 06 6A B5 3B 7C BA 03 F3 91 B8 B6 3D 8A C1 48 2E 50 11 E7 C7 4F B1 27 CF F3 AE 03 09 B2 08 FB DC 22</span></span></code></pre></div><p>分析下，加密的函数应该是这段</p>
<div class="highlight" id="id-17"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">sub_140075052</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v5</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">byte_140197260</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span></span></span></code></pre></div><p>进去看函数的具体实现如下</p>
<div class="highlight" id="id-18"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_1400795E0</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp+4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp+4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp+4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+44h] [rbp+24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+44h] [rbp+24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+64h] [rbp+44h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+64h] [rbp+44h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+A4h] [rbp+84h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="nf">sub_14007555C</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_1401A7007</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a5</span> <span class="o">+</span> <span class="n">i</span> <span class="o">%</span> <span class="n">a6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">v10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v10</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">j</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">a4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">v9</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v9</span><span class="p">)</span> <span class="o">+</span> <span class="n">v11</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v11</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v9</span><span class="p">)</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">v14</span><span class="o">++</span><span class="p">)</span> <span class="o">^=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v11</span><span class="p">)</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">v9</span><span class="p">))</span> <span class="o">%</span> <span class="mi">256</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">--</span><span class="n">a4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>确实是 <code>RC4</code> 的实现，那么解密就很快了，由于该加密是对称加密，所以密文同时也是密文，现在，还需要一个 <code>key</code></p>
<p>在第一段函数体中，可以看到加密函数传参了 <code>6</code> 个参数，其中 <code>v7</code> 是 <code>key</code> ，也就是 <code>moectf2023</code></p>
<p><img loading="lazy" src="/2.png" alt="image-20231008143805723" srcset="/2.png?size=small, /2.png?size=medium 1.5x, /2.png?size=large 2x" data-title="image-20231008143805723" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>解密得到 <code>flag</code></p>
<div class="highlight" id="id-19"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{y0u_r3a11y_understand_rc4!!!!}</span></span></code></pre></div><h2 id="smc" class="heading-element">
  <a href="#smc" class="heading-mark"></a>8 SMC</h2><blockquote>
<p>SMC.exe</p>
</blockquote>
<p>核心的内容如下</p>
<div class="highlight" id="id-20"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main_0</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-78h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-78h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [esp+Ch] [ebp-6Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_401087</span><span class="p">(</span><span class="n">aPlzInputYourFl</span><span class="p">,</span> <span class="n">v4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_401023</span><span class="p">(</span><span class="n">aS</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_4011E0</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_401050</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_401087</span><span class="p">(</span><span class="n">aGood</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_401087</span><span class="p">(</span><span class="n">aTryAgainPlease</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>可知，当满足 <code>sub_401050(v6)</code> 后，即可，但是却无法分析 <code>sub_401050</code> 函数的具体实现</p>
<div class="highlight" id="id-21"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// attributes: thunk
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">sub_401050</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">JUMPOUT</span><span class="p">(</span><span class="mh">0x4014D0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>转到反汇编处，看到跳转到了另一个函数处</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">jmp     loc_4014D0</code></pre><p>跟进后可以看到 <code>loc_4014D0</code> 这个函数的汇编，都是一些赋值操作，但是在最后，有一段数据区</p>
<p><img loading="lazy" src="/3.png" alt="image-20231008145206164" srcset="/3.png?size=small, /3.png?size=medium 1.5x, /3.png?size=large 2x" data-title="image-20231008145206164" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在交叉引用处，发现另外一个函数中，也有此函数出现</p>
<div class="highlight" id="id-23"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">sub_401550</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">DWORD</span> <span class="n">flOldProtect</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [esp+18h] [ebp-8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">flOldProtect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">858993460</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">flOldProtect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">DWORD</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">8u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="nf">VirtualProtect</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loc_4014D0</span> <span class="o">-</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loc_4014D0</span> <span class="o">%</span> <span class="mh">0x1000</span><span class="p">,</span> <span class="mh">0x1000u</span><span class="p">,</span> <span class="mh">0x80u</span><span class="p">,</span> <span class="n">flOldProtect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">122</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loc_4014D0</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">^=</span> <span class="mh">0x66u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>这里将 <code>loc_4014D0</code> 开始的值逐一进行异或，交叉引用后发现，该函数体被入口处的 <code>main</code> 函数体中的 <code>sub_4011E0</code> 方法调用</p>
<p>在调用该函数后，调用了 <code>sub_401050(v6)</code>,所以基本可以确定这个程序在运行时，修改了自身，即 <code>SMC</code> 解释如下</p>
<blockquote>
<p>SMC，即Self Modifying Code，动态代码加密技术，指通过修改代码或数据，阻止别人直接静态分析，然后在动态运行程序时对代码进行解密，达到程序正常运行的效果。
而计算机病毒通常也会采用SMC技术动态修改内存中的可执行代码来达到变形或对代码加密的目的，从而躲过杀毒软件的查杀或者迷惑反病毒工作者对代码进行分析。
通常来说，SMC使用汇编去写会比较好，因为它涉及更改机器码，但SMC也可以直接通过C、C++来实现。</p>
</blockquote>
<p>看到这，差不多就明白了，需要进行动态调试拿到解析后的代码才能分析，那么现在有两种选择</p>
<ol>
<li>动态调试，得到修改后的代码再进行分析</li>
<li>分析程序，自己写代码，手动修改，得到代码</li>
</ol>
<h4 id="方法一" class="heading-element">
  <a href="#%e6%96%b9%e6%b3%95%e4%b8%80" class="heading-mark"></a>8.0.1 方法一</h4><p>先说第一种方法，动态调试，这里选择使用 <code>dbg</code> 进行动态调试，设置函数调用前的断点，并用插件 <code>Scylla</code> 的功能保存当前状态的程序，得到真实的代码</p>
<p><img loading="lazy" src="/4.png" alt="image-20231008182514452" srcset="/4.png?size=small, /4.png?size=medium 1.5x, /4.png?size=large 2x" data-title="image-20231008182514452" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>得到保存后的二进制文件 <code>SMC_dump.exe</code> 后，再使用 <code>ida</code> 重新进行分析，就能看到 <code>sub_401050</code> 函数的真实代码了</p>
<div class="highlight" id="id-24"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">int</span> <span class="n">__cdecl</span> <span class="n">sub_4014D0</span><span class="p">(</span><span class="n">char</span> <span class="o">*</span><span class="n">Str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">size_t</span> <span class="n">i</span><span class="p">;</span> <span class="o">//</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mi">0</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mi">8</span><span class="n">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nb">int</span> <span class="n">v3</span><span class="p">;</span> <span class="o">//</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mi">4</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mi">4</span><span class="n">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">((</span><span class="n">unsigned</span> <span class="n">__int8</span><span class="p">)(</span><span class="n">Str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">57</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x39</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">unsigned</span> <span class="n">__int8</span><span class="p">)</span><span class="n">byte_40A000</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>这段程序中，输入的值先加上 <code>57</code> 再 异或 <code>0x39</code> ，并于密文变量 <code>byte_40A000</code> 一一比较，所以，提取该变量的值，并逆向即可</p>
<h4 id="方法二" class="heading-element">
  <a href="#%e6%96%b9%e6%b3%95%e4%ba%8c" class="heading-mark"></a>8.0.2 方法二</h4><p>第二种方法就是找到程序运行中，修改自身的代码，并复刻修改地址的代码， 手动编写代码运行来修改，从而得到修改后的代码。
上面说了，在函数 <code>sub_401550()</code> 中，就是目标的修改代码，所以我们可以复制他的方法，编写 <code>idc</code> 来手动模拟程序运行到这个方法。
下面是编写的 <code>idc</code> 代码，运行即可</p>
<div class="highlight" id="id-25"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">static</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">auto</span> <span class="n">address</span> <span class="o">=</span> <span class="mh">0x4014d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">auto</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">122</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="nf">PatchByte</span><span class="p">(</span><span class="n">address</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="nf">Byte</span><span class="p">(</span><span class="n">address</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x66</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nf">Message</span><span class="p">(</span><span class="s">&#34;patch ok&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>运行代码后，整个程序变为</p>
<p><img loading="lazy" src="/5.png" alt="image-20231018163422855" srcset="/5.png?size=small, /5.png?size=medium 1.5x, /5.png?size=large 2x" data-title="image-20231018163422855" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>将多余出来，没有识别的数据，识别为汇编即可，然后创建函数，即可反编译，得到解密后的真实代码</p>
<div class="highlight" id="id-26"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">sub_4014D0</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">Str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">Str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">57</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x39</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">byte_40A000</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>最后解密程序如下</p>
<div class="highlight" id="id-27"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;9F 91 A7 A5 94 A6 8D B5 A7 9C A6 A1 BF 91 A4 53 A6 53 A5 A3 94 9B 91 9E 8F&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x39</span><span class="p">)</span> <span class="o">-</span> <span class="mi">57</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></div><p><code>Flag</code> 如下</p>
<div class="highlight" id="id-28"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{Self_Mod1f1cation}</span></span></code></pre></div><h2 id="equation" class="heading-element">
  <a href="#equation" class="heading-mark"></a>9 EQUATION</h2><blockquote>
<p>EQUATION.exe</p>
</blockquote>
<p>用 <code>ida</code> 分析，发现一段很长的多个 <code>if</code> 判断条件，且是运算公式，应该是考察 <code>z3</code> 库的使用，直接贴代码了</p>
<div class="highlight" id="id-29"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ques</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;question.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!=&#39;</span><span class="p">,</span><span class="s1">&#39;==&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">,</span><span class="s1">&#39;*2**&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;||&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">exec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;v4_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = Int(&#39;v4_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ques</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ques</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ques</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">f</span><span class="s2">&#34;v4[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="sa">f</span><span class="s2">&#34;v4_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ques</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">exec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;s.add(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nb">chr</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="nb">int</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">str</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="n">s</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;v4_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span></span></span></code></pre></div><p>其中 <code>question.txt</code> 的内容如下</p>
<div class="highlight" id="id-30"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">334 * v4[28]     + 100 * v4[27]     + 369 * v4[26]     + 124 * v4[25]     + 278 * v4[24]     + 158 * v4[23]     + 162 * v4[22]     + 145 * v4[19]     + 27 * v4[17]     + 91 * v4[15]     + 195 * v4[14]     + 342 * v4[13]     + 391 * v4[10]     + 204 * v4[9]     + 302 * v4[8]     + 153 * v4[7]     + 292 * v4[6]     + 382 * v4[5]     + 221 * v4[4]     + 316 * v4[3]     + 118 * v4[2]     + 295 * v4[1]     + 247 * v4[0]     + 236 * v4[11]     + 27 * v4[12]     + 361 * v4[16]     + 81 * v4[18]     + 105 * v4[20]     + 65 * v4[21]     + 67 * v4[29]     + 41 * v4[30] != 596119    || 371 * v4[29]     + 338 * v4[28]     + 269 * v4[27]     + 312 * v4[26]     + 67 * v4[25]     + 299 * v4[24]     + 235 * v4[23]     + 294 * v4[22]     + 303 * v4[21]     + 211 * v4[20]     + 122 * v4[19]     + 333 * v4[18]     + 341 * v4[15]     + 111 * v4[14]     + 253 * v4[13]     + 68 * v4[12]     + 347 * v4[11]     + 44 * v4[10]     + 262 * v4[9]     + 357 * v4[8]     + 323 * v4[5]     + 141 * v4[4]     + 329 * v4[3]     + 378 * v4[2]     + 316 * v4[1]     + 235 * v4[0]     + 59 * v4[6]     + 37 * v4[7]     + 264 * v4[16]     + 73 * v4[17]     + 126 * v4[30] != 634009    || 337 * v4[29]     + 338 * v4[28]     + 118 * v4[27]     + 82 * v4[26]     + 239 * v4[21]     + 58 * v4[20]     + 304 * v4[19]     + 330 * v4[18]     + 377 * v4[17]     + 306 * v4[16]     + 221 * v4[13]     + 345 * v4[12]     + 124 * v4[11]     + 272 * v4[10]     + 270 * v4[9]     + 229 * v4[8]     + 377 * v4[7]     + 373 * v4[6]     + 297 * v4[5]     + 112 * v4[4]     + 386 * v4[3]     + 90 * v4[2]     + 361 * v4[1]     + 236 * v4[0]     + 386 * v4[14]     + 73 * v4[15]     + 315 * v4[22]     + 33 * v4[23]     + 141 * v4[24]     + 129 * v4[25]     + 123 * v4[30] != 685705    || 367 * v4[29]     + 55 * v4[28]     + 374 * v4[27]     + 150 * v4[24]     + 350 * v4[23]     + 141 * v4[22]     + 124 * v4[21]     + 366 * v4[20]     + 230 * v4[19]     + 307 * v4[18]     + 191 * v4[17]     + 153 * v4[12]     + 383 * v4[11]     + 145 * v4[10]     + 109 * v4[9]     + 209 * v4[8]     + 158 * v4[7]     + 221 * v4[6]     + 188 * v4[5]     + 22 * v4[4]     + 146 * v4[3]     + 306 * v4[2]     + 230 * v4[1]     + 13 * v4[0]     + 287 * v4[13]     + 257 * v4[14]     + 137 * v4[15]     + 7 * v4[16]     + 52 * v4[25]     + 31 * v4[26]     + 355 * v4[30] != 557696    || 100 * v4[29]     + 191 * v4[28]     + 362 * v4[27]     + 55 * v4[26]     + 210 * v4[25]     + 359 * v4[24]     + 348 * v4[21]     + 83 * v4[20]     + 395 * v4[19]     + 350 * v4[16]     + 291 * v4[15]     + 220 * v4[12]     + 196 * v4[11]     + 399 * v4[8]     + 68 * v4[7]     + 84 * v4[6]     + 281 * v4[5]     + 334 * v4[4]     + 53 * v4[3]     + 399 * v4[2]     + 338 * v4[0]     + 18 * v4[1]     + 148 * v4[9]     + 21 * v4[10]     + 174 * v4[13]     + 36 * v4[14]     + 2 * v4[17]     + 41 * v4[18]     + 137 * v4[22]     + 24 * v4[23]     + 368 * v4[30] != 538535    || 188 * v4[29]     + (v4[26] &lt;&lt; 7)     + 93 * v4[25]     + 248 * v4[24]     + 83 * v4[23]     + 207 * v4[22]     + 217 * v4[19]     + 309 * v4[16]     + 16 * v4[15]     + 135 * v4[14]     + 251 * v4[13]     + 200 * v4[12]     + 49 * v4[11]     + 119 * v4[10]     + 356 * v4[9]     + 398 * v4[8]     + 303 * v4[7]     + 224 * v4[6]     + 208 * v4[5]     + 244 * v4[4]     + 209 * v4[3]     + 189 * v4[2]     + 302 * v4[1]     + 395 * v4[0]     + 314 * v4[17]     + 13 * v4[18]     + 310 * v4[20]     + 21 * v4[21]     + 67 * v4[27]     + 127 * v4[28]     + 100 * v4[30] != 580384    || 293 * v4[29]     + 343 * v4[28]     + 123 * v4[27]     + 387 * v4[26]     + 114 * v4[25]     + 303 * v4[24]     + 248 * v4[23]     + 258 * v4[21]     + 218 * v4[20]     + 180 * v4[19]     + 196 * v4[18]     + 398 * v4[17]     + 398 * v4[14]     + 138 * v4[9]     + 292 * v4[8]     + 38 * v4[7]     + 179 * v4[6]     + 190 * v4[5]     + 57 * v4[4]     + 358 * v4[3]     + 191 * v4[2]     + 215 * v4[1]     + 88 * v4[0]     + 22 * v4[10]     + 72 * v4[11]     + 357 * v4[12]     + 9 * v4[13]     + 389 * v4[15]     + 81 * v4[16]     + 85 * v4[30] != 529847    || 311 * v4[29]     + 202 * v4[28]     + 234 * v4[27]     + 272 * v4[26]     + 55 * v4[25]     + 328 * v4[24]     + 246 * v4[23]     + 362 * v4[22]     + 86 * v4[21]     + 75 * v4[20]     + 142 * v4[17]     + 244 * v4[16]     + 216 * v4[15]     + 281 * v4[14]     + 398 * v4[13]     + 322 * v4[12]     + 251 * v4[11]     + 357 * v4[8]     + 76 * v4[7]     + 292 * v4[6]     + 389 * v4[5]     + 275 * v4[4]     + 312 * v4[3]     + 200 * v4[2]     + 110 * v4[1]     + 203 * v4[0]     + 99 * v4[9]     + 21 * v4[10]     + 269 * v4[18]     + 33 * v4[19]     + 356 * v4[30] != 631652    || 261 * v4[29]     + 189 * v4[26]     + 55 * v4[25]     + 23 * v4[24]     + 202 * v4[23]     + 185 * v4[22]     + 182 * v4[21]     + 285 * v4[20]     + 217 * v4[17]     + 157 * v4[16]     + 232 * v4[15]     + 132 * v4[14]     + 169 * v4[13]     + 154 * v4[12]     + 121 * v4[11]     + 389 * v4[10]     + 376 * v4[9]     + 292 * v4[6]     + 225 * v4[5]     + 155 * v4[4]     + 234 * v4[3]     + 149 * v4[2]     + 241 * v4[1]     + 312 * v4[0]     + 368 * v4[7]     + 129 * v4[8]     + 226 * v4[18]     + 288 * v4[19]     + 201 * v4[27]     + 288 * v4[28]     + 69 * v4[30] != 614840    || 60 * v4[29]     + 118 * v4[28]     + 153 * v4[27]     + 139 * v4[26]     + 23 * v4[25]     + 279 * v4[24]     + 396 * v4[23]     + 287 * v4[22]     + 237 * v4[19]     + 266 * v4[18]     + 149 * v4[17]     + 193 * v4[16]     + 395 * v4[15]     + 97 * v4[14]     + 16 * v4[13]     + 286 * v4[12]     + 105 * v4[11]     + 88 * v4[10]     + 282 * v4[9]     + 55 * v4[8]     + 134 * v4[7]     + 114 * v4[6]     + 101 * v4[5]     + 116 * v4[4]     + 271 * v4[3]     + 186 * v4[2]     + 263 * v4[1]     + 313 * v4[0]     + 149 * v4[20]     + 129 * v4[21]     + 145 * v4[30] != 510398    || 385 * v4[29]     + 53 * v4[28]     + 112 * v4[27]     + 8 * v4[26]     + 232 * v4[25]     + 145 * v4[24]     + 313 * v4[23]     + 156 * v4[22]     + 321 * v4[21]     + 358 * v4[20]     + 46 * v4[19]     + 382 * v4[18]     + 144 * v4[16]     + 222 * v4[14]     + 329 * v4[13]     + 161 * v4[12]     + 335 * v4[11]     + 50 * v4[10]     + 373 * v4[9]     + 66 * v4[8]     + 44 * v4[7]     + 59 * v4[6]     + 292 * v4[5]     + 39 * v4[4]     + 53 * v4[3]     + 310 * v4[0]     + 154 * v4[1]     + 24 * v4[2]     + 396 * v4[15]     + 81 * v4[17]     + 355 * v4[30] != 558740    || 249 * v4[29]     + 386 * v4[28]     + 313 * v4[27]     + 74 * v4[26]     + 22 * v4[25]     + 168 * v4[24]     + 305 * v4[21]     + 358 * v4[20]     + 191 * v4[19]     + 202 * v4[18]     + 14 * v4[15]     + 114 * v4[14]     + 224 * v4[13]     + 134 * v4[12]     + 274 * v4[11]     + 372 * v4[10]     + 159 * v4[9]     + 233 * v4[8]     + 70 * v4[7]     + 287 * v4[6]     + 297 * v4[5]     + 318 * v4[4]     + 177 * v4[3]     + 173 * v4[2]     + 270 * v4[1]     + 163 * v4[0]     + 77 * v4[16]     + 25 * v4[17]     + 387 * v4[22]     + 18 * v4[23]     + 345 * v4[30] != 592365    || 392 * v4[29]     + 385 * v4[28]     + 302 * v4[27]     + 13 * v4[25]     + 27 * v4[24]     + 99 * v4[22]     + 343 * v4[19]     + 324 * v4[18]     + 223 * v4[17]     + 372 * v4[16]     + 261 * v4[15]     + 181 * v4[14]     + 203 * v4[13]     + 232 * v4[12]     + 305 * v4[11]     + 393 * v4[10]     + 325 * v4[9]     + 231 * v4[8]     + 92 * v4[7]     + 142 * v4[6]     + 22 * v4[5]     + 86 * v4[4]     + 264 * v4[3]     + 300 * v4[2]     + 387 * v4[1]     + 360 * v4[0]     + 225 * v4[20]     + 127 * v4[21]     + 2 * v4[23]     + 80 * v4[26]     + 268 * v4[30] != 619574    || 270 * v4[28]     + 370 * v4[27]     + 235 * v4[26]     + 96 * v4[22]     + 85 * v4[20]     + 150 * v4[19]     + 140 * v4[18]     + 94 * v4[17]     + 295 * v4[16]     + 19 * v4[14]     + 176 * v4[12]     + 94 * v4[11]     + 258 * v4[10]     + 302 * v4[9]     + 171 * v4[8]     + 66 * v4[7]     + 278 * v4[6]     + 193 * v4[5]     + 251 * v4[4]     + 284 * v4[3]     + 218 * v4[2]     + (v4[1] &lt;&lt; 6)     + 319 * v4[0]     + 125 * v4[13]     + 24 * v4[15]     + 267 * v4[21]     + 160 * v4[23]     + 111 * v4[24]     + 33 * v4[25]     + 174 * v4[29]     + 13 * v4[30] != 480557    || 87 * v4[28]     + 260 * v4[27]     + 326 * v4[26]     + 210 * v4[25]     + 357 * v4[24]     + 170 * v4[23]     + 315 * v4[22]     + 376 * v4[21]     + 227 * v4[20]     + 43 * v4[19]     + 358 * v4[18]     + 364 * v4[17]     + 309 * v4[16]     + 282 * v4[15]     + 286 * v4[14]     + 365 * v4[13]     + 287 * v4[12]     + 377 * v4[11]     + 74 * v4[10]     + 225 * v4[9]     + 328 * v4[6]     + 223 * v4[5]     + 120 * v4[4]     + 102 * v4[3]     + 162 * v4[2]     + 123 * v4[1]     + 196 * v4[0]     + 29 * v4[7]     + 27 * v4[8]     + 352 * v4[30] != 666967    || 61 * v4[29]     + 195 * v4[28]     + 125 * v4[27]     + (v4[26] &lt;&lt; 6)     + 260 * v4[25]     + 202 * v4[24]     + 116 * v4[23]     + 230 * v4[22]     + 326 * v4[21]     + 211 * v4[20]     + 371 * v4[19]     + 353 * v4[16]     + 124 * v4[13]     + 188 * v4[12]     + 163 * v4[11]     + 140 * v4[10]     + 51 * v4[9]     + 262 * v4[8]     + 229 * v4[7]     + 100 * v4[6]     + 113 * v4[5]     + 158 * v4[4]     + 378 * v4[3]     + 365 * v4[2]     + 207 * v4[1]     + 277 * v4[0]     + 190 * v4[14]     + 320 * v4[15]     + 347 * v4[17]     + 11 * v4[18]     + 137 * v4[30] != 590534    || 39 * v4[28]     + 303 * v4[27]     + 360 * v4[26]     + 157 * v4[25]     + 324 * v4[24]     + 77 * v4[23]     + 308 * v4[22]     + 313 * v4[21]     + 87 * v4[20]     + 201 * v4[19]     + 50 * v4[18]     + 60 * v4[17]     + 28 * v4[16]     + 193 * v4[15]     + 184 * v4[14]     + 205 * v4[13]     + 140 * v4[12]     + 311 * v4[11]     + 304 * v4[10]     + 35 * v4[9]     + 356 * v4[8]     + 23 * v4[5]     + 85 * v4[4]     + 156 * v4[3]     + 16 * v4[2]     + 26 * v4[1]     + 157 * v4[0]     + 150 * v4[6]     + 72 * v4[7]     + 58 * v4[29] != 429108    || 157 * v4[29]     + 137 * v4[28]     + 71 * v4[27]     + 269 * v4[26]     + 161 * v4[25]     + 317 * v4[20]     + 296 * v4[19]     + 385 * v4[18]     + 165 * v4[13]     + 159 * v4[12]     + 132 * v4[11]     + 296 * v4[10]     + 162 * v4[7]     + 254 * v4[4]     + 172 * v4[3]     + 132 * v4[0]     + 369 * v4[1]     + 257 * v4[2]     + 134 * v4[5]     + 384 * v4[6]     + 53 * v4[8]     + 255 * v4[9]     + 229 * v4[14]     + 129 * v4[15]     + 23 * v4[16]     + 41 * v4[17]     + 112 * v4[21]     + 17 * v4[22]     + 222 * v4[23]     + 96 * v4[24]     + 126 * v4[30] != 563521    || 207 * v4[29]     + 83 * v4[28]     + 111 * v4[27]     + 35 * v4[26]     + 67 * v4[25]     + 138 * v4[22]     + 223 * v4[21]     + 142 * v4[20]     + 154 * v4[19]     + 111 * v4[18]     + 341 * v4[17]     + 175 * v4[16]     + 259 * v4[15]     + 225 * v4[14]     + 26 * v4[11]     + 334 * v4[10]     + 250 * v4[7]     + 198 * v4[6]     + 279 * v4[5]     + 301 * v4[4]     + 193 * v4[3]     + 334 * v4[2]     + 134 * v4[0]     + 37 * v4[1]     + 183 * v4[8]     + 5 * v4[9]     + 270 * v4[12]     + 21 * v4[13]     + 275 * v4[23]     + 48 * v4[24]     + 163 * v4[30] != 493999    || 393 * v4[29]     + 176 * v4[28]     + 105 * v4[27]     + 162 * v4[26]     + 148 * v4[25]     + 281 * v4[24]     + 300 * v4[23]     + 342 * v4[18]     + 262 * v4[17]     + 152 * v4[12]     + 43 * v4[11]     + 296 * v4[10]     + 273 * v4[9]     + 75 * v4[6]     + 18 * v4[4]     + 217 * v4[2]     + 132 * v4[1]     + 112 * v4[0]     + 210 * v4[3]     + 72 * v4[5]     + 113 * v4[7]     + 40 * v4[8]     + 278 * v4[13]     + 24 * v4[14]     + 77 * v4[15]     + 11 * v4[16]     + 55 * v4[19]     + 255 * v4[20]     + 241 * v4[21]     + 13 * v4[22]     + 356 * v4[30] != 470065    || 369 * v4[29]     + 231 * v4[28]     + 285 * v4[25]     + 290 * v4[24]     + 297 * v4[23]     + 189 * v4[22]     + 390 * v4[21]     + 345 * v4[20]     + 153 * v4[19]     + 114 * v4[18]     + 251 * v4[17]     + 340 * v4[16]     + 44 * v4[15]     + 58 * v4[14]     + 335 * v4[13]     + 359 * v4[12]     + 392 * v4[11]     + 181 * v4[8]     + 103 * v4[7]     + 229 * v4[6]     + 175 * v4[5]     + 208 * v4[4]     + 92 * v4[3]     + 397 * v4[2]     + 349 * v4[1]     + 356 * v4[0]     + (v4[9] &lt;&lt; 6)     + 5 * v4[10]     + 88 * v4[26]     + 40 * v4[27]     + 295 * v4[30] != 661276    || 341 * v4[27]     + 40 * v4[25]     + 374 * v4[23]     + 201 * v4[22]     + 77 * v4[21]     + 215 * v4[20]     + 283 * v4[19]     + 213 * v4[18]     + 392 * v4[17]     + 224 * v4[16]     + v4[15]     + 270 * v4[12]     + 28 * v4[11]     + 75 * v4[8]     + 386 * v4[7]     + 298 * v4[6]     + 170 * v4[5]     + 287 * v4[4]     + 247 * v4[3]     + 204 * v4[2]     + 103 * v4[1]     + 21 * v4[0]     + 84 * v4[9]     + 27 * v4[10]     + 159 * v4[13]     + 192 * v4[14]     + 213 * v4[24]     + 129 * v4[26]     + 67 * v4[28]     + 27 * v4[29]     + 361 * v4[30] != 555288    || 106 * v4[29]     + 363 * v4[28]     + 210 * v4[27]     + 171 * v4[26]     + 289 * v4[25]     + 240 * v4[24]     + 164 * v4[23]     + 342 * v4[22]     + 391 * v4[19]     + 304 * v4[18]     + 218 * v4[17]     + 32 * v4[16]     + 350 * v4[15]     + 339 * v4[12]     + 303 * v4[11]     + 222 * v4[10]     + 298 * v4[9]     + 47 * v4[8]     + 48 * v4[6]     + 264 * v4[4]     + 113 * v4[3]     + 275 * v4[2]     + 345 * v4[1]     + 312 * v4[0]     + 171 * v4[5]     + 384 * v4[7]     + 175 * v4[13]     + 5 * v4[14]     + 113 * v4[20]     + 19 * v4[21]     + 263 * v4[30] != 637650    || 278 * v4[29]     + 169 * v4[28]     + 62 * v4[27]     + 119 * v4[26]     + 385 * v4[25]     + 289 * v4[24]     + 344 * v4[23]     + 45 * v4[20]     + 308 * v4[19]     + 318 * v4[18]     + 270 * v4[17]     + v4[16]     + 323 * v4[15]     + 332 * v4[14]     + 287 * v4[11]     + 170 * v4[10]     + 163 * v4[9]     + 301 * v4[8]     + 303 * v4[7]     + 23 * v4[6]     + 327 * v4[5]     + 169 * v4[3]     + 28 * v4[0]     + 365 * v4[1]     + 15 * v4[2]     + 352 * v4[12]     + 72 * v4[13]     + 140 * v4[21]     + 65 * v4[22]     + 346 * v4[30] != 572609    || 147 * v4[29]     + 88 * v4[28]     + 143 * v4[27]     + 237 * v4[26]     + 63 * v4[24]     + 281 * v4[22]     + 388 * v4[21]     + 142 * v4[20]     + 208 * v4[19]     + 60 * v4[18]     + 354 * v4[15]     + 88 * v4[14]     + 146 * v4[13]     + 290 * v4[12]     + 349 * v4[11]     + 43 * v4[10]     + 230 * v4[9]     + 267 * v4[6]     + 136 * v4[5]     + 383 * v4[4]     + 35 * v4[3]     + 226 * v4[2]     + 385 * v4[1]     + 238 * v4[0]     + 348 * v4[7]     + 20 * v4[8]     + 158 * v4[16]     + 21 * v4[17]     + 249 * v4[23]     + 9 * v4[25]     + 343 * v4[30] != 603481    || 29 * v4[29]     + 323 * v4[26]     + 159 * v4[25]     + 118 * v4[20]     + 326 * v4[19]     + 211 * v4[18]     + 225 * v4[17]     + 355 * v4[16]     + 201 * v4[15]     + 149 * v4[14]     + 296 * v4[13]     + 184 * v4[12]     + 315 * v4[11]     + 364 * v4[10]     + 142 * v4[9]     + 75 * v4[8]     + 313 * v4[7]     + 142 * v4[6]     + 396 * v4[5]     + 348 * v4[4]     + 272 * v4[3]     + 26 * v4[2]     + 206 * v4[1]     + 173 * v4[0]     + 155 * v4[21]     + 144 * v4[22]     + 366 * v4[23]     + 257 * v4[24]     + 148 * v4[27]     + 24 * v4[28]     + 253 * v4[30] != 664504    || 4 * v4[29]     + 305 * v4[28]     + 226 * v4[27]     + 212 * v4[26]     + 175 * v4[25]     + 93 * v4[24]     + 165 * v4[23]     + 341 * v4[20]     + 14 * v4[19]     + 394 * v4[18]     + (v4[17] &lt;&lt; 8)     + 252 * v4[16]     + 336 * v4[15]     + 38 * v4[14]     + 82 * v4[13]     + 155 * v4[12]     + 215 * v4[11]     + 331 * v4[10]     + 230 * v4[9]     + 241 * v4[8]     + 225 * v4[7]     + 186 * v4[4]     + 90 * v4[3]     + 50 * v4[2]     + 62 * v4[1]     + 34 * v4[0]     + 237 * v4[5]     + 11 * v4[6]     + 336 * v4[21]     + 36 * v4[22]     + 29 * v4[30] != 473092    || 353 * v4[29]     + 216 * v4[28]     + 252 * v4[27]     + 8 * v4[26]     + 62 * v4[25]     + 233 * v4[24]     + 254 * v4[23]     + 303 * v4[22]     + 234 * v4[21]     + 303 * v4[20]     + (v4[19] &lt;&lt; 8)     + 148 * v4[18]     + 324 * v4[17]     + 317 * v4[16]     + 213 * v4[15]     + 309 * v4[14]     + 28 * v4[13]     + 280 * v4[11]     + 118 * v4[10]     + 58 * v4[9]     + 50 * v4[8]     + 155 * v4[7]     + 161 * v4[6]     + (v4[5] &lt;&lt; 6)     + 303 * v4[4]     + 76 * v4[3]     + 43 * v4[2]     + 109 * v4[1]     + 102 * v4[0]     + 93 * v4[30] != 497492    || 89 * v4[29]     + 148 * v4[28]     + 82 * v4[27]     + 53 * v4[26]     + 274 * v4[25]     + 220 * v4[24]     + 202 * v4[23]     + 123 * v4[22]     + 231 * v4[21]     + 169 * v4[20]     + 278 * v4[19]     + 259 * v4[18]     + 208 * v4[17]     + 219 * v4[16]     + 371 * v4[15]     + 181 * v4[12]     + 104 * v4[11]     + 392 * v4[10]     + 285 * v4[9]     + 113 * v4[8]     + 298 * v4[7]     + 389 * v4[6]     + 322 * v4[5]     + 338 * v4[4]     + 237 * v4[3]     + 234 * v4[0]     + 261 * v4[1]     + 10 * v4[2]     + 345 * v4[13]     + 3 * v4[14]     + 361 * v4[30] != 659149    || 361 * v4[29]     + 359 * v4[28]     + 93 * v4[27]     + 315 * v4[26]     + 69 * v4[25]     + 137 * v4[24]     + 69 * v4[23]     + 58 * v4[22]     + 300 * v4[21]     + 371 * v4[20]     + 264 * v4[19]     + 317 * v4[18]     + 215 * v4[17]     + 155 * v4[16]     + 215 * v4[15]     + 330 * v4[14]     + 239 * v4[13]     + 212 * v4[12]     + 88 * v4[11]     + 82 * v4[10]     + 354 * v4[9]     + 85 * v4[8]     + 310 * v4[7]     + 84 * v4[6]     + 374 * v4[5]     + 380 * v4[4]     + 215 * v4[3]     + 351 * v4[2]     + 141 * v4[1]     + 115 * v4[0]     + 108 * v4[30]!= 629123</span></span></code></pre></div><p>运行后，得到 <code>flag</code></p>
<div class="highlight" id="id-31"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{y0u_s0lv3d_Equati0ns!!!}</span></span></code></pre></div><h2 id="junk_code" class="heading-element">
  <a href="#junk_code" class="heading-mark"></a>10 junk_code</h2><blockquote>
<p>junk_code.exe</p>
</blockquote>
<p>这道题考的是花指令混淆的对抗，程序的主要代码如下</p>
<div class="highlight" id="id-32"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main_0</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">Str</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span> <span class="c1">// [esp+E8h] [ebp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v5</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span> <span class="c1">// [esp+FAh] [ebp-1Eh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_543007</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">j__puts</span><span class="p">(</span><span class="s">&#34;welcome to moectf</span><span class="se">\n</span><span class="s">your flag:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_4591AE</span><span class="p">(</span><span class="s">&#34;%36s&#34;</span><span class="p">,</span> <span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">j__strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">18</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_45A9A0</span><span class="p">(</span><span class="n">Str</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nf">sub_459EBF</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">j__puts</span><span class="p">(</span><span class="s">&#34;congratulations!!!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="nf">j__puts</span><span class="p">(</span><span class="s">&#34;WORNG!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">j__puts</span><span class="p">(</span><span class="s">&#34;WORNG!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>分析后可得知，函数 <code>sub_45A9A0</code> 和函数 <code>sub_459EBF</code> 是判断对错的关键，所以猜测 <code>flag</code> 长度是 <code>18*2=36</code> ，通过两个函数中的运算得到各自的一半</p>
<p>进入函数发现无法编译，应该就是在这对抗花指令</p>
<p><img loading="lazy" src="/6.png" alt="image-20231018174335393" srcset="/6.png?size=small, /6.png?size=medium 1.5x, /6.png?size=large 2x" data-title="image-20231018174335393" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>看汇编发现，最后的 <code>jz</code> 跳转是无效的，而 <code>loc_460612</code> 函数处的内容，也是无效的，所以取消定义<code>U</code> ，并将内容改为 <code>nop</code> ,最后回到原函数 <code>sub_45A9A0</code> 处，重新识别为函数即可正常编译</p>
<p>得到伪代码</p>
<div class="highlight" id="id-33"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">sub_4605D0</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+D3h] [ebp-3Dh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-34h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-34h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-34h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="c1">// [esp+F4h] [ebp-1Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int16</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+104h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v7</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="n">a1</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v7</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v7</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">-=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">aHjOavtPzmHQ</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v7</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>而第二个函数 <code>sub_459EBF</code> 的操作过程同理，最后得到如下伪代码</p>
<div class="highlight" id="id-34"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">BOOL</span> <span class="kr">__cdecl</span> <span class="nf">sub_460750</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">Str2</span><span class="p">,</span> <span class="kt">signed</span> <span class="kt">int</span> <span class="n">MaxCount</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+D4h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCount</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Str2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x66u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">j__strncmp</span><span class="p">(</span><span class="n">Str1</span><span class="p">,</span> <span class="n">Str2</span><span class="p">,</span> <span class="n">MaxCount</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>分析后，最后的解密代码如下</p>
<div class="highlight" id="id-35"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">enc1</span> <span class="o">=</span> <span class="s2">&#34;hj`^oavt+pZm`h+q._&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">enc2</span> <span class="o">=</span> <span class="s2">&#34;39 12 0E 55 39 0C 13 08 0D 39 05 56 02 55 47 47 47 1B&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">enc1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">enc2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x66</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">);</span></span></span></code></pre></div><p>运行后即可得到 <code>flag</code></p>
<div class="highlight" id="id-36"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{y0u_rem0v3d_th3_junk_c0d3!!!}</span></span></code></pre></div><h2 id="ezandroid" class="heading-element">
  <a href="#ezandroid" class="heading-mark"></a>11 ezandroid</h2><blockquote>
<p>ezandroid.apk</p>
</blockquote>
<p>使用 <code>jadx</code> 工具反编译 <code>apk</code> ，在 <code>com.doctor3.ezandroid</code> 中的 <code>MainActivity</code> 方法，内有一个外部库的引入</p>
<div class="highlight" id="id-37"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">static</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">&#34;ezandroid&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div><p>同时还申明了 <code>navtive</code> 函数 <code>check</code></p>
<p>主要代码如下</p>
<div class="highlight" id="id-38"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">btn</span><span class="p">.</span><span class="na">setOnClickListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">View</span><span class="p">.</span><span class="na">OnClickListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// from class: com.doctor3.ezandroid.MainActivity.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="c1">// android.view.View.OnClickListener</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onClick</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">view</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getText</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">23</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;长度不对哦&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">check</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Context</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;OK!RIGHT,flag is moectf{&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">getApplicationContext</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;Try to reverse the native lib!&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span></span></span></code></pre></div><p>可以看到大致逻辑，调用了 <code>check</code> 函数来判断 <code>flag</code> 是否正确，这个时候就要去看 <code>ezandroid</code> 这个引入的库是什么内容</p>
<p>使用 <code>ida</code> 分析 <code>apk</code> 中的 <code>libezandroid.so</code> 文件，发现有个 <code>JNI_OnLoad</code> 函数，应该就是注册 <code>native</code> 的入口，所以应该是动态注册，且规定了一串文本</p>
<p><code>******************@**************.************...****#..*****.********.*****.****.....*****.****.*********......***********************</code></p>
<p>且另外有个函数也调用了这串文本，代码如下</p>
<div class="highlight" id="id-39"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">_BOOL8</span> <span class="kr">__fastcall</span> <span class="nf">sub_E80</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+Fh] [rbp-19h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BOOL4</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">asc_3C30</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">a1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="n">v4</span> <span class="o">!=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v1</span> <span class="o">=</span> <span class="n">a1</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">switch</span> <span class="p">(</span> <span class="o">*</span><span class="n">v1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="o">--</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;d&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="o">++</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;s&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">v4</span> <span class="o">+=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;w&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">v4</span> <span class="o">-=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="o">*</span><span class="n">v4</span> <span class="o">==</span> <span class="mi">35</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>看到有 <code>adsw</code> 这些，并且上下是位移 <code>15</code>,左右是 <code>1</code> ，可以猜测是迷宫题了，且是个 <code>9*15</code> 的迷宫</p>
<p>整理输出后的迷宫如下</p>
<div class="highlight" id="id-40"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">***************
</span></span><span class="line"><span class="cl">***@***********
</span></span><span class="line"><span class="cl">***.***********
</span></span><span class="line"><span class="cl">*...****#..****
</span></span><span class="line"><span class="cl">*.********.****
</span></span><span class="line"><span class="cl">*.****.....****
</span></span><span class="line"><span class="cl">*.****.********
</span></span><span class="line"><span class="cl">*......********
</span></span><span class="line"><span class="cl">***************</span></span></code></pre></div><p>走到 <code>#</code> 即可</p>
<div class="highlight" id="id-41"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">moectf{ssaassssdddddwwwddddwwwa}</span></span></code></pre></div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-10-08 13:26:44">更新于 2023-10-08&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="//localhost:1313/posts/2023moectf-reverse-wp/" data-title="2023MoeCTF(Reverse入门学习)" data-hashtags="2023MoeCTF,Reverse"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="//localhost:1313/posts/2023moectf-reverse-wp/" data-hashtag="2023MoeCTF"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="//localhost:1313/posts/2023moectf-reverse-wp/" data-title="2023MoeCTF(Reverse入门学习)"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/2023moectf/" class="post-tag" title="标签 - 2023MoeCTF">2023MoeCTF</a><a href="/tags/reverse/" class="post-tag" title="标签 - Reverse">Reverse</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav">
      <a href="/posts/89d59c3/" class="post-nav-item" rel="next" title="2023NewStarCTF Week1 WP(Reverse)">2023NewStarCTF Week1 WP(Reverse)<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.124.0"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.2"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span><span class="license footer-divider"><a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' target='_blank'>CC BY-NC-SA 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='网站运行中……'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i><span class="ms-1 d-none">网站已运行</span><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="icp footer-divider"><a target='_blank' href='https://beian.miit.gov.cn'><span>浙ICP备2022018709号-1</span></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/algoliasearch/algoliasearch-lite.umd.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"LJYZFDIC3K","algoliaIndex":"Hexo","algoliaSearchKey":"f59c07279f0701e0a70735d6d84f4751","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30,"type":"algolia"},"siteTime":"2024-03-20T10:12:22+08:00"};</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>
